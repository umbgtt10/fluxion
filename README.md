# fluxion

Licensed under either of:

- Apache License, Version 2.0 ([LICENSE-APACHE](LICENSE-APACHE) or http://www.apache.org/licenses/LICENSE-2.0)
- MIT license ([LICENSE-MIT](LICENSE-MIT) or http://opensource.org/licenses/MIT)

[![CI](https://github.com/umbgtt10/fluxion/actions/workflows/ci.yml/badge.svg)](https://github.com/umbgtt10/fluxion/actions/workflows/ci.yml)
[![Coverage](https://github.com/umbgtt10/fluxion/actions/workflows/ci.yml/badge.svg)](https://github.com/umbgtt10/fluxion/actions/workflows/ci.yml)

Fluxion is a 100% Rust implementation of composite Rx-style stream operators and helpers focused on correct temporal ordering and efficient async processing.

Quick links
- Crates: `fluxion-stream`, `fluxion-exec`, `fluxion-test-utils`
- Docs: generated by `cargo doc` (see `target/doc`)

Getting started

Prerequisites: Rust (recommended toolchain is pinned by `rust-toolchain.toml`).

- Build and run tests for the whole workspace:

```powershell
cargo build --all
cargo test --all-features --all-targets
```

- Run the local CI helper (PowerShell):

```powershell
powershell -NoProfile -ExecutionPolicy Bypass -File .\.ci\ci.ps1
```

Workspace overview

- `fluxion-stream` — stream combinators and timestamping helpers (ordering guarantees)
- `fluxion-exec` — execution utilities and subscription helpers for async processing
- `fluxion-test-utils` — shared test helpers, fixtures and sample data used by tests

Development notes

- Clippy, formatting and documentation warnings are treated as errors in CI.
- Local scripts live in `.ci/` (use `coverage.ps1` to collect coverage locally with `cargo-llvm-cov`).

TODOs:
- [ ] Review all performance benches:
    - Ensure consistency
	- Double-check sample sizes and test duration
	- Ensure reasonable complexity of the benches
	- Consider adding additional cases
- [ ] Investigate a clean way to suppress unit-test harness noise when running `cargo bench`.
	- Consider options: `cargo -q bench`, running the bench binary directly, per-package bench (`-p`), or a `.ci/bench.ps1` wrapper that builds then executes bench executables.
- [ ] Rework/review ci.yml
	- Consider options: add code coverage
	- Improve speed
	- Consider removing unnecessary steps
	- Check whether new steps should be added
- [ ] Windows double-versioning issue:
    - Resolve `windows-sys` multiple-version issue on Windows
	- Symptom: both `windows-sys 0.60.x` and `0.61.x` appear in `Cargo.lock` (clippy flags `multiple_crate_versions`).
	- Options:
	   - bump workspace `tokio`/transitive crates so they align [DONE]
	   - pin `socket2`/`mio` to compatible versions [NOT DONE]
	   - or accept both and suppress the clippy lint in CI. [DONE]
	- Fix / workaround:
       - suppress Clippy at crate level with #![allow(clippy::multiple_crate_versions, clippy::doc_markdown)] [DONE]
       - or add a [patch.crates-io] override for the transitive crate (preferred over forcing windows-sys directly) [NOT DONE]
	- Note: attempting to force windows-sys = "0.61.2" may fail if an upstream crate requires ^0.60; use cargo tree -i to inspect dependency paths before attempting a pin/patch
	- Optimal solution: update tokio / related transitive crates to versions that align their windows-sys reqs, remove any suppressions/pins and re-run cargo update (may require coordinated upgrades).
	- Quick checks:
		```
		cargo tree -i windows-sys@0.60.2 --workspace
		cargo tree -i windows-sys@0.61.2 --workspace
		cargo tree -i windows-sys --workspace
		```
		Use `cargo update` after edits to `Cargo.toml` to refresh `Cargo.lock`.


Issues & contributions

Contributions are welcome. Please open issues and PRs. Use the existing CI scripts to verify changes locally before pushing.

License

MIT OR Apache-2.0
